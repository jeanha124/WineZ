<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Wine in the USA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
  <script src="https://d3js.org/d3.v4.min.js"></script>
  <!-- <script src="https://maps.google.com/maps/api/js?sensor=true"></script> -->
  <script src="https://d3js.org/topojson.v2.min.js"></script>
  <script src="http://d3js.org/queue.v1.min.js"></script>
  <script src="http://d3js.org/d3-geo-projection.v2.min.js"></script>
  <style>
    header {
      text-align: center;
    }
    .states {
      fill: #e5e5e5;
      stroke: #fff;
      stroke-width: 2px;
    }
    .states :hover {
      fill: #722f37;
    }
    .state-borders {
      fill: none;
      stroke-width: 1px;
    }
    footer {
      font: 20px;
      text-align: center;
    }
  </style>
</head>
<body>
  <header><h1>Wine in the USA</h1></header>
  <div id="map"></div>
  
  <script>
    let margin = {top: 50, left: 50, right: 50, bottom: 50},
    height = 700 - margin.top - margin.bottom,
    width = 1000 - margin.left - margin.right;

    let svg = d3.select("#map")
                .append("svg")
                .attr("height", height + margin.top + margin.bottom)
                .attr("width", width + margin.left + margin.right)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

           
    let path = d3.geoPath()
          
    
    let longlat = [{
      name: 'Alabama',
      lat: 32.806671,
      lon: -86.791130
    },{
      name: 'Alaska',
      lat: 61.370716,
      lon: -152.404419
    },{
      name: 'Arizona',
      lat: 33.729759,
      lon: -111.431221
    }, {
      name: 'Arkansas',
      lat: 34.969704,
      lon: -92.373123
    },{
      name: 'California',
      lat: 36.116203,
      lon: -119.681564
    },{
      name: 'Colorado',
      lat: 39.059811,
      lon: -105.311104
    },{
      name: 'Connecticut',
      lat: 41.597782,
      lon: -105.311104
    },{
      name: 'Delaware',
      lat: 39.318523,
      lon: -75.507141
    },{
      name: 'District of Columbia',
      lat: 38.897438,
      lon: -77.026817
    },{
      name: 'Florida',
      lat: 27.766279,
      lon: -81.686783
    },{
      name: 'Georgia',
      lat: 33.040619,
      lon: -83.643074
    }, {
      name: 'Hawaii',
      lat: 21.094318,
      lon: -157.498337
    }, {
      name: 'Idaho',
      lat: 44.240459,
      lon: -114.478828
    }, {
      name: 'Illinois',
      lat: 40.349457,
      lon: -88.986137
    }, {
      name: 'Indiana',
      lat: 39.849426,
      lon: -86.258278
    }, {
      name: 'Iowa',
      lat: 42.011539,
      lon: -93.210526
    }, {
      name: 'Kansas',
      lat: 38.526600,
      lon: -96.726486
    }, {
      name: 'Kentucky',
      lat: 37.668140,
      lon: -84.670067
    }, {
      name: 'Louisiana',
      lat: 31.169546,
      lon: -91.867805
    }, {
      name: 'Maine',
      lat: 44.693947,
      lon: -69.381927
    }, {
      name: 'Maryland',
      lat: 39.063946,
      lon: -76.802101
    }, {
      name: 'Massachusetts',
      lat: 42.230171,
      lon: -71.530106
    }, {
      name: 'Michigan',
      lat: 43.326618,
      lon: -84.536095
    }, {
      name: 'Minnesota',
      lat: 45.694454,
      lon: -93.900192
    }, {
      name: 'Mississippi',
      lat: 32.741646,
      lon: -89.678696
    }, {
      name: 'Missouri',
      lat: 38.456085,
      lon: -92.288368
    }, {
      name: 'Montana',
      lat: 46.921925,
      lon: -110.454353
    }, {
      name: 'Nebraska',
      lat: 41.125370,
      lon: -98.268082
    }, {
      name: 'Nevada',
      lat: 38.313515,
      lon: -117.055374
    }, {
      name: 'New Hampshire',
      lat: 43.452492,
      lon: -71.563896
    }, {
      name: 'New Jersey',
      lat: 40.298904,
      lon: -74.521011
    }, {
      name: 'New Mexico',
      lat: 34.840515,
      lon: -106.248482
    }, {
      name: 'New York',
      lat: 42.165726,
      lon: -74.948051
    }, {
      name: 'North Carolina',
      lat: 35.630066,
      lon: -79.806419
    }, {
      name: 'North Dakota',
      lat: 47.528912,
      lon: -99.784012
    }, {
      name: 'Ohio',
      lat: 40.388783,
      lon: -82.764915
    }, {
      name: 'Oklahoma',
      lat: 35.565342,
      lon: -82.764915
    }, {
      name: 'Oregon',
      lat: 44.572021,
      lon: -122.070938
    }, {
      name: 'Pennsylvania',
      lat: 40.590752,
      lon: -77.209755
    }, {
      name: 'Rhode Island',
      lat: 41.680893,
      lon: -71.511780
    }, {
      name: 'South Carolina',
      lat: 33.856892,
      lon: -80.945007
    }, {
      name: 'South Dakota',
      lat: 44.299782,
      lon: -99.438828
    }, {
      name: 'Tennessee',
      lat: 35.747845,
      lon: -86.692345
    }, {
      name: 'Texas',
      lat: 31.054487,
      lon: -97.563461
    }, {
      name: 'Utah',
      lat: 40.150032,
      lon: -111.862434
    }, {
      name: 'Vermont',
      lat: 44.045876,
      lon: -72.710686
    }, {
      name: 'Virgina',
      lat: 37.769337,
      lon: -78.169968
    }, {
      name: 'Washington',
      lat: 47.400902,
      lon: -121.490494
    }, {
      name: 'West Virgina',
      lat: 38.491226,
      lon: -80.954453
    }, {
      name: 'Wisconsin',
      lat: 44.268543,
      lon: -89.616508
    }, {
      name: 'Wyoming',
      lat: 42.755966,
      lon: -107.302490
    }
    ];   
    
    let data = d3.csv("https://raw.githubusercontent.com/jeanha124/WineZ/master/wine-data2.csv", (d) => {
          return {
            title: d.title,
            description: d.description,
            variety: d.variety,
            winery: d.winery,
            province: d.province,
            points: d.points,
            price: d.price
        };
    }, function (data) {
      data.forEach(function(d){
      let result = longlat.filter(function(lonlat){
      return lonlat.name === d.province;
      });
      d.lonlat = (result[0] !== undefined) ? [result[0].lon, result[0].lat] : null;
      });
      console.log(data);
    });


    

    d3.json("https://d3js.org/us-10m.v1.json", function(error, us){
      if (error) throw error;

      svg.append("g")
         .attr("class", "states")
         .selectAll("path")
         .data(topojson.feature(us, us.objects.states).features)
         .enter().append("path")
         .attr("d", path);
      svg.append("path")
         .attr("class", "state-borders")
         .attr("d", path(topojson.mesh(us, us.objects.states, function(a, b) { return a !== b; }))); 
      svg.selectAll('circle')
         .data(data.features).enter()
         .append('circle')
         .attr('cx', function(d){ return projection(d.lonlat)[0]})
         .attr('cx', function(d){ return projection(d.lonlat)[1]})
         .attr('r', '10px')
         .attr('fill', 'green')
           
    });

  </script>
  <footer style='width: 100%; background: red; position: absolute; bottom: 0;'>
      <a style='color: white;' href='https://jeanwooha.me'>Portfolio</a>
      <a style='color: white;' href='https://linkedin.com/in/jeanha124'>LinkedIn</a>
      <a style='color: white;' href='https://github.com/jeanha124'>Github</a>
  </footer>
</body>
</html>